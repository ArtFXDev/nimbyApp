<!DOCTYPE html>

<head>
  <title>Nimby App</title>
  <link rel="stylesheet" href="./css/main.css">
</head>

<body>
  <div class="center">
    <h1>Nimby App <span id="marker"></span></h1>
    <p id="version"></p>
    <p>
      This tool if for check if you using your pc and avoid job render on your pc.
    </p>
    <p id="nimbyStatus"></p>
    <div id="root"></div>
    <div id="main_switch">
      <span class="switchSpan">Manual</span>
      <label class="switch">
        <input id="btn_enable_disable" type="checkbox" checked>
        <span class="slider"></span>
      </label>
      <span class="switchSpan">Auto</span>
    </div>
  </div>
  <div id="legend">
    <div class="legend-line"><span class="dotGreen"></span><span class="legend-text">Nimby is ON : You are protected from renderfarm jobs</span></div>
    <div class="legend-line"><span class="dotRed"></span><span class="legend-text">Nimby is OFF : Job can be send on your PC (pass in Manual mode to change nimby ON)</span></div>
    <span class="legend-text smaller">Auto mode will be enable at 18h. <a href="mailto:td5-mtp@artfx.fr" style="margin-left: 120px;" title="td5-mtp@artfx.fr">Contact us.</a></span>
    
  </div>

  <script>
    const { ipcRenderer } = require('electron');
    const version = document.getElementById('version');
    const nimbyStatusElement = document.getElementById('nimbyStatus');
    const nimbyModStatusElement = document.getElementById('nimbyModStatus');
    const marker = document.getElementById('marker');

    const btnModeEnableDisable = document.getElementById('btn_enable_disable');

    ipcRenderer.send('app_version');
    ipcRenderer.on('app_version', (event, arg) => {
      ipcRenderer.removeAllListeners('app_version');
      version.innerText = 'Version ' + arg.version;

    });

    btnModeEnableDisable.addEventListener('click', (event) => {
      ipcRenderer.send('on_switch_nimby_mod');
    });

    ipcRenderer.send('get_nimby_status');
    ipcRenderer.on('nimby_status', (event, arg) => {
      arg.nimby ? marker.className = 'dotGreen' : marker.className = 'dotRed'
      nimbyStatusElement.innerText = `Nimby is : ${arg.nimby ? "ON" : "OFF"}`
      btnModeEnableDisable.checked = arg.autoMod ? true : false;
    });

  </script>
</body>
